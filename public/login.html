<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign in to VERA</title>
  <style>
    :root {
      --bg: #0f1221;
      --card: #171a2b;
      --text: #e8e7f0;
      --muted: #a9a6c3;
      --accent: #8c7ae6;
      --accent-2: #6c5ce7;
      --error: #ff6b6b;
      --success: #2ecc71;
      --border: rgba(255,255,255,0.1);
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; background: radial-gradient(1200px 800px at 70% -10%, rgba(140,122,230,0.2), transparent), var(--bg); color: var(--text); }
    .wrap { min-height: 100vh; display: grid; place-items: center; padding: 32px; }
    .card { width: 100%; max-width: 480px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border: 1px solid var(--border); border-radius: 16px; padding: 28px; box-shadow: 0 10px 40px rgba(0,0,0,0.35); }
    .title { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .orb { width: 36px; height: 36px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #c7b8ff, #6c5ce7); box-shadow: 0 0 30px rgba(140,122,230,0.5); }
    h1 { font-size: 1.25rem; margin: 0; font-weight: 600; letter-spacing: .02em; }
    p { color: var(--muted); margin: 0 0 18px 0; }
    label { display:block; font-size: .9rem; color: var(--muted); margin-bottom: 6px; }
    input { width: 100%; padding: 12px 14px; background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 10px; outline: none; transition: border .2s, box-shadow .2s; }
    input:focus { border-color: rgba(140,122,230,0.6); box-shadow: 0 0 0 4px rgba(140,122,230,0.15); }
    .actions { display:flex; gap: 12px; align-items:center; margin-top: 14px; }
    button { appearance: none; border: 0; background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: white; padding: 12px 16px; border-radius: 10px; font-weight: 600; cursor: pointer; box-shadow: 0 10px 20px rgba(108,92,231,0.3); }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .link { color: var(--muted); text-decoration: none; }
    .msg { margin-top: 12px; font-size: .95rem; }
    .msg.error { color: var(--error); }
    .msg.success { color: var(--success); }
    .hint { font-size: .85rem; color: var(--muted); margin-top: 8px; }
  </style>
  <meta name="robots" content="noindex" />
  <link rel="icon" href="/favicon.svg" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#667eea">
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Sign in to continue your conversation with VERA." />
  <script defer>
    async function sendMagicLink(e) {
      e.preventDefault();
      const emailEl = document.getElementById('email');
      const btn = document.getElementById('submitBtn');
      const msg = document.getElementById('msg');
      const email = emailEl.value.trim();
      msg.textContent = '';
      msg.className = 'msg';
      if (!email || !email.includes('@')) { msg.textContent = 'Please enter a valid email.'; msg.classList.add('error'); return; }
      btn.disabled = true;
      try {
        const res = await fetch('/api/auth/send-magic-link', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email }) });
        const data = await res.json();
        if (!res.ok) { throw new Error(data.error || 'Failed to send magic link'); }
        msg.textContent = 'Check your email for the sign-in link. It expires in 15 minutes.';
        msg.classList.add('success');
      } catch (err) {
        msg.textContent = err.message;
        msg.classList.add('error');
      } finally { btn.disabled = false; }
    }
  </script>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <div class="title">
          <div class="orb"></div>
          <h1>Sign in to VERA</h1>
        </div>
        <p>We’ll email you a secure one-time link to continue your conversation.</p>
        <form onsubmit="sendMagicLink(event)">
          <label for="email">Email</label>
          <input id="email" type="email" placeholder="you@example.com" autocomplete="email" required />
          <div class="actions">
            <button id="submitBtn" type="submit">Send sign-in link</button>
            <a class="link" href="/chat.html">Back to chat</a>
          </div>
          <div id="msg" class="msg" role="status" aria-live="polite"></div>
          <div class="hint">After clicking the link in your email, you’ll be returned to VERA.</div>
        </form>
      </div>
    </div>
  </body>
</html>
